{
    "name": "MONTHLY_VAT",
    "type": "VIEW",
    "query": "SELECT \n    DATE_TRUNC('month', TRANSACTION_DATE) AS DUE_DATE,\n    SUM(VAT) AS PAYABLE_VAT\nFROM (\n    SELECT \n        SALESINVOICE_DATE AS TRANSACTION_DATE,\n        SALESINVOICE_VAT AS VAT\n    FROM CODBEX_SALESINVOICE\n    UNION ALL\n    SELECT \n        PURCHASEINVOICE_DATE AS TRANSACTION_DATE,\n        -PURCHASEINVOICE_VAT AS VAT\n    FROM CODBEX_PURCHASEINVOICE\n) AS CombinedData\nGROUP BY DATE_TRUNC('month', TRANSACTION_DATE)\nORDER BY DUE_DATE DESC;",
    "dependencies": []
}