{
    "name": "MONTHLY_VAT",
    "type": "VIEW",
    "query": "SELECT \n    DATEADD(month, 1, DATE_TRUNC('month', TRANSACTION_DATE)) AS DATE,\n    SUM(SALES_VAT) AS SALES_VAT,\n    SUM(PURCHASE_VAT) AS PURCHASE_VAT,\n    SUM(SALES_VAT - PURCHASE_VAT) AS PAYABLE_VAT\nFROM (\n    SELECT \n        SALESINVOICE_DATE AS TRANSACTION_DATE,\n        SALESINVOICE_VAT AS SALES_VAT,\n        0 AS PURCHASE_VAT\n    FROM CODBEX_SALESINVOICE\n    UNION ALL\n    SELECT \n        PURCHASEINVOICE_DATE AS TRANSACTION_DATE,\n        0 AS SALES_VAT,\n        PURCHASEINVOICE_VAT AS PURCHASE_VAT\n    FROM CODBEX_PURCHASEINVOICE\n) AS CombinedData\nGROUP BY DATEADD(month, 1, DATE_TRUNC('month', TRANSACTION_DATE))\nORDER BY DATE DESC;",
    "dependencies": []
}